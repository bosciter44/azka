<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AZKA_SERVER_V3_STABLE_GPT</title>
    <style>
        :root { --neon: #39FF14; --bg: #000; }
        body { background: var(--bg); color: var(--neon); font-family: 'Courier New', monospace; padding: 20px; margin: 0; }
        .container { max-width: 800px; margin: auto; border: 2px solid var(--neon); padding: 20px; box-shadow: 0 0 20px rgba(57, 255, 20, 0.3); }
        .header { text-align: center; border-bottom: 2px solid var(--neon); padding-bottom: 10px; margin-bottom: 20px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        .slot { border: 1px dashed var(--neon); height: 150px; display: flex; align-items: center; justify-content: center; background: #0a0a0a; cursor: pointer; overflow: hidden; position: relative; }
        .slot img { width: 100%; height: 100%; object-fit: cover; }
        textarea { width: 100%; background: #000; color: var(--neon); border: 1px solid var(--neon); padding: 15px; box-sizing: border-box; font-family: inherit; margin-bottom: 15px; }
        .btn { width: 100%; background: transparent; color: var(--neon); border: 2px solid var(--neon); padding: 15px; cursor: pointer; font-weight: bold; text-transform: uppercase; letter-spacing: 2px; transition: 0.3s; }
        .btn:hover { background: var(--neon); color: #000; box-shadow: 0 0 20px var(--neon); }
        #terminal { margin-top: 20px; border: 1px solid var(--neon); background: #050505; padding: 15px; min-height: 150px; white-space: pre-wrap; font-size: 13px; }
        .loader { color: yellow; display: none; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0; } }
    </style>
</head>
<body>

<div class="container">
    <div class="header"><h1>[ AZKA_STABLE_V3_GPT ]</h1></div>
    
    <div class="grid">
        <div class="slot" onclick="sel(0)">UPLOAD_01</div>
        <div class="slot" onclick="sel(1)">UPLOAD_02</div>
    </div>

    <input type="file" id="f0" hidden onchange="pv(event, 0)">
    <input type="file" id="f1" hidden onchange="pv(event, 1)">

    <textarea id="cmd" rows="2" placeholder="> MASUKKAN PERINTAH CHATGPT (Contoh: Apa isi foto ini?)"></textarea>
    <button class="btn" onclick="execute()">PROSES DENGAN CHATGPT</button>

    <div id="terminal">
        <div id="ld" class="loader">> CONNECTING_TO_OPENAI_UPLINK... BYPASSING_FIREWALL...</div>
        <div id="out">> SYSTEM_READY. AWAITING_CHATGPT_API_KEY.</div>
    </div>
</div>

<script type="module">
    // --- KONFIGURASI API KEY ---
    // Masukkan API Key OpenAI kamu di sini (Format: sk-proj-xxxx...)
    const OPENAI_API_KEY = "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";

    window.sel = (i) => document.getElementById(`f${i}`).click();
    window.pv = (e, i) => {
        const file = e.target.files[0];
        if (file) {
            const r = new FileReader();
            r.onload = (ev) => document.querySelectorAll('.slot')[i].innerHTML = `<img src="${ev.target.result}">`;
            r.readAsDataURL(file);
        }
    };

    window.execute = async () => {
        const out = document.getElementById('out');
        const ld = document.getElementById('ld');
        const promptText = document.getElementById('cmd').value;
        const fileElements = [document.getElementById('f0').files[0], document.getElementById('f1').files[0]].filter(Boolean);

        if (OPENAI_API_KEY === "MASUKKAN_API_KEY_CHATGPT_DISINI") {
            return alert("Error: Kamu belum memasukkan API Key ChatGPT di dalam kode!");
        }

        if (fileElements.length === 0) return alert("Hacker, upload minimal 1 foto!");

        ld.style.display = "block";
        out.innerHTML = "";

        try {
            // Konversi file ke Base64 untuk OpenAI format
            const imageContents = await Promise.all(fileElements.map(async (f) => {
                const b64 = await new Promise(r => {
                    const reader = new FileReader();
                    reader.onload = () => r(reader.result.split(',')[1]);
                    reader.readAsDataURL(f);
                });
                return {
                    type: "image_url",
                    image_url: { url: `data:${f.type};base64,${b64}` }
                };
            }));

            // Payload untuk API OpenAI
            const payload = {
                model: "gpt-4o-mini", // Model tercepat & termurah yang mendukung visi
                messages: [
                    {
                        role: "user",
                        content: [
                            { type: "text", text: promptText || "Apa yang ada di foto ini?" },
                            ...imageContents
                        ]
                    }
                ],
                max_tokens: 1000
            };

            const response = await fetch("https://api.openai.com/v1/chat/completions", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": `Bearer ${OPENAI_API_KEY}`
                },
                body: JSON.stringify(payload)
            });

            const result = await response.json();

            if (!response.ok) {
                throw new Error(result.error ? result.error.message : "Gagal terhubung ke OpenAI");
            }

            ld.style.display = "none";
            out.innerHTML = `[ GPT_SUCCESS ]\n\n${result.choices[0].message.content}`;

        } catch (err) {
            ld.style.display = "none";
            out.innerHTML = `[ GPT_ERROR ]\n${err.message}\n\nSaran: Pastikan saldo API OpenAI kamu mencukupi dan Key benar.`;
        }
    };
</script>

</body>
</html>
